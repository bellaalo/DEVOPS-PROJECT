updating the code version 3